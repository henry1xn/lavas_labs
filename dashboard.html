<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Lavas Labs - Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div class="dashboard-layout">
      <!-- Sidebar -->
      <aside class="dashboard-sidebar">
        <header class="brand sidebar-brand">
          <p class="brand-label" aria-label="Lavas Labs">LAVAS LABS</p>
        </header>
        <nav class="sidebar-nav">
          <div class="nav-group">
            <a href="#overview" class="nav-item active" data-i18n="navOverview">
              <span>概览</span>
            </a>
          <a href="#virtual-cards" class="nav-item nav-sub-item" data-i18n="navVirtualCards">
            <span data-i18n="navVirtualCards">My virtual cards</span>
          </a>
          </div>
          <a href="wallet.html" class="nav-item" data-i18n="navWallet">
            <span>钱包</span>
          </a>
          <a href="#employees" class="nav-item" data-i18n="navEmployees">
            <span>员工管理</span>
          </a>
          <a href="#transactions" class="nav-item" data-i18n="navTransactions">
            <span>交易记录</span>
          </a>
          <a href="#expenses" class="nav-item" data-i18n="navExpenses">
            <span>费用分析</span>
          </a>
          <a href="settings.html" class="nav-item" data-i18n="navSettings">
            <span>设置</span>
          </a>
        </nav>
      </aside>

      <!-- Main Content -->
      <main class="dashboard-main">
        <!-- Top Bar -->
        <header class="dashboard-header">
          <div class="header-left">
            <h1 class="page-title" data-i18n="pageTitle">仪表板</h1>
          </div>
          <div class="header-right">
            <section class="language-fab" aria-label="Language selector">
              <input type="checkbox" id="lang-toggle" />
              <label for="lang-toggle" class="fab" title="Change language">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"/>
                  <path d="M2 12h20M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
                </svg>
              </label>
              <div class="fab-menu" role="menu">
                <button type="button" class="lang-option active" data-lang="zh">中文</button>
                <button type="button" class="lang-option" data-lang="en">EN</button>
                <button type="button" class="lang-option" data-lang="ja">日本語</button>
                <button type="button" class="lang-option" data-lang="de">Deutsch</button>
                <button type="button" class="lang-option" data-lang="vi">Tiếng Việt</button>
              </div>
            </section>
            <div class="user-menu">
              <button class="user-avatar" data-i18n="userMenu">用户</button>
            </div>
          </div>
        </header>

        <!-- Overview Cards -->
        <section class="dashboard-section">
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-header">
                <span class="stat-label" data-i18n="statTotalBalance">总余额</span>
              </div>
              <div class="stat-value">
                <span class="currency">USDT</span>
                <span class="amount">1,234,567.89</span>
              </div>
              <div class="stat-change positive" data-i18n="statChange">+12.5% 本月</div>
            </div>

            <div class="stat-card">
              <div class="stat-header">
                <span class="stat-label" data-i18n="statAvailable">可用余额</span>
              </div>
              <div class="stat-value">
                <span class="currency">USDT</span>
                <span class="amount">987,654.32</span>
              </div>
              <div class="stat-change" data-i18n="statReady">可用于分配</div>
            </div>

            <div class="stat-card">
              <div class="stat-header">
                <span class="stat-label" data-i18n="statEmployees">员工总数</span>
              </div>
              <div class="stat-value">
                <span class="amount">42</span>
              </div>
              <div class="stat-change" data-i18n="statActive">38 活跃</div>
            </div>

            <div class="stat-card">
              <div class="stat-header">
                <span class="stat-label" data-i18n="statMonthlyExpense">本月支出</span>
              </div>
              <div class="stat-value">
                <span class="currency">USDT</span>
                <span class="amount">245,890.12</span>
              </div>
              <div class="stat-change negative" data-i18n="statVsLastMonth">-8.2% 较上月</div>
            </div>
          </div>
        </section>

        <!-- Quick Actions -->
        <section class="dashboard-section">
          <h2 class="section-title" data-i18n="quickActions">快速操作</h2>
          <div class="actions-grid">
            <button class="action-card" data-i18n="actionDeposit">
              <span class="action-label">法币充值</span>
              <span class="action-desc" data-i18n="actionDepositDesc">通过 Ramp 充值法币并自动转换为 USDT</span>
            </button>
            <button class="action-card" data-i18n="actionAllocate">
              <span class="action-label">分配额度</span>
              <span class="action-desc" data-i18n="actionAllocateDesc">为员工分配 USDT 使用额度</span>
            </button>
            <button class="action-card" data-i18n="actionOSL">
              <span class="action-label">OSL 集成</span>
              <span class="action-desc" data-i18n="actionOSLDesc">管理 OSL 交易所连接与配置</span>
            </button>
            <button class="action-card" data-i18n="actionReports">
              <span class="action-label">生成报告</span>
              <span class="action-desc" data-i18n="actionReportsDesc">导出费用与交易报告</span>
            </button>
          </div>
        </section>

        <!-- Recent Transactions -->
        <section class="dashboard-section">
          <div class="section-header">
            <h2 class="section-title" data-i18n="recentTransactions">最近交易</h2>
            <a href="#transactions" class="view-all" data-i18n="viewAll">查看全部</a>
          </div>
          <div class="transactions-table">
            <table>
              <thead>
                <tr>
                  <th data-i18n="txDate">日期</th>
                  <th data-i18n="txType">类型</th>
                  <th data-i18n="txEmployee">员工</th>
                  <th data-i18n="txAmount">金额</th>
                  <th data-i18n="txStatus">状态</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>2024-01-15</td>
                  <td><span class="tx-badge deposit" data-i18n="txDeposit">充值</span></td>
                  <td>—</td>
                  <td class="amount-positive">+50,000 USDT</td>
                  <td><span class="status-badge success" data-i18n="txCompleted">已完成</span></td>
                </tr>
                <tr>
                  <td>2024-01-14</td>
                  <td><span class="tx-badge allocate" data-i18n="txAllocate">分配</span></td>
                  <td>张三</td>
                  <td class="amount-negative">-5,000 USDT</td>
                  <td><span class="status-badge success" data-i18n="txCompleted">已完成</span></td>
                </tr>
                <tr>
                  <td>2024-01-14</td>
                  <td><span class="tx-badge expense" data-i18n="txExpense">支出</span></td>
                  <td>李四</td>
                  <td class="amount-negative">-2,340 USDT</td>
                  <td><span class="status-badge success" data-i18n="txCompleted">已完成</span></td>
                </tr>
                <tr>
                  <td>2024-01-13</td>
                  <td><span class="tx-badge allocate" data-i18n="txAllocate">分配</span></td>
                  <td>王五</td>
                  <td class="amount-negative">-10,000 USDT</td>
                  <td><span class="status-badge pending" data-i18n="txPending">处理中</span></td>
                </tr>
                <tr>
                  <td>2024-01-12</td>
                  <td><span class="tx-badge deposit" data-i18n="txDeposit">充值</span></td>
                  <td>—</td>
                  <td class="amount-positive">+100,000 USDT</td>
                  <td><span class="status-badge success" data-i18n="txCompleted">已完成</span></td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <!-- Employee Overview -->
        <section class="dashboard-section">
          <div class="section-header">
            <h2 class="section-title" data-i18n="topEmployees">活跃员工</h2>
            <a href="#employees" class="view-all" data-i18n="viewAll">查看全部</a>
          </div>
          <div class="employees-grid">
            <div class="employee-card">
              <div class="employee-avatar">张</div>
              <div class="employee-info">
                <div class="employee-name">张三</div>
                <div class="employee-role" data-i18n="roleDeveloper">开发工程师</div>
              </div>
              <div class="employee-stats">
                <div class="employee-balance">
                  <span class="balance-label" data-i18n="balance">余额</span>
                  <span class="balance-amount">8,500 USDT</span>
                </div>
                <div class="employee-usage">
                  <span class="usage-label" data-i18n="usage">本月使用</span>
                  <span class="usage-amount">1,500 USDT</span>
                </div>
              </div>
            </div>
            <div class="employee-card">
              <div class="employee-avatar">李</div>
              <div class="employee-info">
                <div class="employee-name">李四</div>
                <div class="employee-role" data-i18n="roleManager">项目经理</div>
              </div>
              <div class="employee-stats">
                <div class="employee-balance">
                  <span class="balance-label" data-i18n="balance">余额</span>
                  <span class="balance-amount">12,000 USDT</span>
                </div>
                <div class="employee-usage">
                  <span class="usage-label" data-i18n="usage">本月使用</span>
                  <span class="usage-amount">2,340 USDT</span>
                </div>
              </div>
            </div>
            <div class="employee-card">
              <div class="employee-avatar">王</div>
              <div class="employee-info">
                <div class="employee-name">王五</div>
                <div class="employee-role" data-i18n="roleDesigner">产品设计师</div>
              </div>
              <div class="employee-stats">
                <div class="employee-balance">
                  <span class="balance-label" data-i18n="balance">余额</span>
                  <span class="balance-amount">5,200 USDT</span>
                </div>
                <div class="employee-usage">
                  <span class="usage-label" data-i18n="usage">本月使用</span>
                  <span class="usage-amount">800 USDT</span>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Virtual Cards Page (Sub-navigation) -->
        <section id="virtual-cards-page" class="dashboard-section virtual-cards-section" style="display: none;">
          <div class="section-header">
            <h2 class="section-title" data-i18n="virtualCardsTitle">My virtual cards</h2>
            <div class="section-header-actions">
              <a href="#all-cards" class="view-all" data-i18n="allVirtualCards">All virtual cards →</a>
              <button class="btn-add-card" data-i18n="addCard" onclick="openNewCardDrawer()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"></line>
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                <span>新增虚拟卡</span>
              </button>
            </div>
          </div>
          <div class="virtual-cards-grid" id="virtual-cards-grid">
            <!-- Virtual cards will be rendered here -->
          </div>
        </section>
      </main>
    </div>

    <!-- New Virtual Card Drawer -->
    <div class="drawer-overlay" id="new-card-drawer-overlay" onclick="window.closeNewCardDrawer()"></div>
    <div class="drawer" id="new-card-drawer">
      <div class="drawer-header">
        <button class="drawer-back" onclick="window.closeNewCardDrawer()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
        </button>
        <h2 class="drawer-title" data-i18n="newCardTitle">New virtual card</h2>
        <button class="drawer-close" onclick="window.closeNewCardDrawer()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="drawer-body">
        <form class="new-card-form" id="new-card-form" onsubmit="handleCardSubmit(event)">
          <div class="form-group">
            <label for="card-type" data-i18n="cardType">
              <span data-i18n-text="cardType">卡种类</span><span class="required">*</span>
            </label>
            <select id="card-type" name="cardType" required>
              <option value="" data-i18n="selectOption">请选择</option>
              <option value="reap">reap</option>
              <option value="bluebanc">bluebanc</option>
              <option value="bridge">bridge</option>
            </select>
          </div>

          <div class="form-group">
            <label for="card-purpose" data-i18n="cardPurpose">
              <span data-i18n-text="cardPurpose">What is it for?</span><span class="required">*</span>
            </label>
            <input
              type="text"
              id="card-purpose"
              name="purpose"
              placeholder="Team Software Subscription (One Time)"
              data-i18n-placeholder="cardPurposePlaceholder"
              required
            />
          </div>

          <div class="form-group">
            <label for="card-amount" data-i18n="cardAmount">
              <span data-i18n-text="cardAmount">Amount</span><span class="required">*</span>
            </label>
            <input
              type="number"
              id="card-amount"
              name="amount"
              placeholder="0.00"
              step="0.01"
              min="0"
              required
            />
          </div>

          <div class="form-group">
            <label for="card-currency" data-i18n="cardCurrency">
              <span data-i18n-text="cardCurrency">Currency</span><span class="required">*</span>
            </label>
            <select id="card-currency" name="currency" required>
              <option value="" data-i18n="selectOption">请选择</option>
              <option value="USD">USD</option>
              <option value="HKD">HKD</option>
              <option value="EUR">EUR</option>
            </select>
          </div>

          <div class="form-group">
            <label for="card-frequency" data-i18n="cardFrequency">
              <span data-i18n-text="cardFrequency">Frequency</span><span class="required">*</span>
            </label>
            <select id="card-frequency" name="frequency" required>
              <option value="" data-i18n="selectOption">请选择</option>
              <option value="Total" data-i18n="frequencyTotal">Total</option>
              <option value="Daily" data-i18n="frequencyDaily">Daily</option>
              <option value="Weekly" data-i18n="frequencyWeekly">Weekly</option>
              <option value="Monthly" data-i18n="frequencyMonthly">Monthly - limit resets every calendar month</option>
              <option value="Quarterly" data-i18n="frequencyQuarterly">Quarterly</option>
              <option value="Yearly" data-i18n="frequencyYearly">Yearly</option>
            </select>
          </div>

          <div class="form-group">
            <label for="card-details" data-i18n="cardDetails">
              <span data-i18n-text="cardDetails">Request details</span>
            </label>
            <textarea
              id="card-details"
              name="details"
              rows="4"
              placeholder="What else should we know about this request?"
              data-i18n-placeholder="cardDetailsPlaceholder"
            ></textarea>
          </div>

          <div class="form-group">
            <details class="advanced-section">
              <summary class="advanced-summary" data-i18n="advancedSettings">Advanced</summary>
              <div class="advanced-content">
                <p class="advanced-placeholder" data-i18n="advancedPlaceholder">
                  Sharing / Receipts, memos, and reviews / Spending controls and restrictions
                </p>
              </div>
            </details>
          </div>

          <div class="form-actions">
            <button type="button" class="btn-secondary" onclick="window.closeNewCardDrawer()" data-i18n="cancel">Cancel</button>
            <button type="submit" class="btn-primary" data-i18n="requestCard">Request card</button>
          </div>
        </form>
      </div>
    </div>

    <script>
      (function () {
        const translations = {
          zh: {
            navOverview: "概览",
            navWallet: "钱包",
            navEmployees: "员工管理",
            navTransactions: "交易记录",
            navExpenses: "费用分析",
            navSettings: "设置",
            pageTitle: "仪表板",
            userMenu: "用户",
            statTotalBalance: "总余额",
            statChange: "+12.5% 本月",
            statAvailable: "可用余额",
            statReady: "可用于分配",
            statEmployees: "员工总数",
            statActive: "38 活跃",
            statMonthlyExpense: "本月支出",
            statVsLastMonth: "-8.2% 较上月",
            quickActions: "快速操作",
            actionDeposit: "法币充值",
            actionDepositDesc: "通过 Ramp 充值法币并自动转换为 USDT",
            actionAllocate: "分配额度",
            actionAllocateDesc: "为员工分配 USDT 使用额度",
            actionOSL: "OSL 集成",
            actionOSLDesc: "管理 OSL 交易所连接与配置",
            actionReports: "生成报告",
            actionReportsDesc: "导出费用与交易报告",
            recentTransactions: "最近交易",
            viewAll: "查看全部",
            txDate: "日期",
            txType: "类型",
            txEmployee: "员工",
            txAmount: "金额",
            txStatus: "状态",
            txDeposit: "充值",
            txAllocate: "分配",
            txExpense: "支出",
            txCompleted: "已完成",
            txPending: "处理中",
            topEmployees: "活跃员工",
            roleDeveloper: "开发工程师",
            roleManager: "项目经理",
            roleDesigner: "产品设计师",
            balance: "余额",
            usage: "本月使用",
            navVirtualCards: "我的虚拟卡",
            virtualCardsTitle: "我的虚拟卡",
            allVirtualCards: "所有虚拟卡 →",
            addCard: "新增虚拟卡",
            newCardTitle: "新增虚拟卡",
            cardType: "卡种类",
            cardPurpose: "用途",
            cardPurposePlaceholder: "Team Software Subscription (One Time)",
            cardAmount: "金额",
            cardCurrency: "货币",
            cardFrequency: "频率",
            cardDetails: "申请详情",
            cardDetailsPlaceholder: "What else should we know about this request?",
            advancedSettings: "高级设置",
            advancedPlaceholder: "Sharing / Receipts, memos, and reviews / Spending controls and restrictions",
            cancel: "取消",
            requestCard: "申请卡片",
            cardStatusPending: "待处理",
            cardStatusActive: "激活",
            cardStatusFrozen: "冻结",
            cardRequested: "申请日期",
            cardAvailable: "可用",
            cardLimit: "限额",
            cardApproval: "0/1 审批",
            cardUsed: "已使用",
            selectOption: "请选择",
            frequencyTotal: "总计",
            frequencyDaily: "每日",
            frequencyWeekly: "每周",
            frequencyMonthly: "每月 - 每月重置限额",
            frequencyQuarterly: "每季度",
            frequencyYearly: "每年",
          },
          en: {
            navOverview: "Overview",
            navWallet: "Wallet",
            navEmployees: "Employees",
            navTransactions: "Transactions",
            navExpenses: "Expenses",
            navSettings: "Settings",
            pageTitle: "Dashboard",
            userMenu: "User",
            statTotalBalance: "Total Balance",
            statChange: "+12.5% this month",
            statAvailable: "Available",
            statReady: "Ready to allocate",
            statEmployees: "Total Employees",
            statActive: "38 active",
            statMonthlyExpense: "Monthly Expense",
            statVsLastMonth: "-8.2% vs last month",
            quickActions: "Quick Actions",
            actionDeposit: "Deposit Fiat",
            actionDepositDesc: "Deposit fiat via Ramp and auto-convert to USDT",
            actionAllocate: "Allocate Budget",
            actionAllocateDesc: "Allocate USDT budget to employees",
            actionOSL: "OSL Integration",
            actionOSLDesc: "Manage OSL exchange connection & config",
            actionReports: "Generate Reports",
            actionReportsDesc: "Export expense & transaction reports",
            recentTransactions: "Recent Transactions",
            viewAll: "View All",
            txDate: "Date",
            txType: "Type",
            txEmployee: "Employee",
            txAmount: "Amount",
            txStatus: "Status",
            txDeposit: "Deposit",
            txAllocate: "Allocate",
            txExpense: "Expense",
            txCompleted: "Completed",
            txPending: "Pending",
            topEmployees: "Active Employees",
            roleDeveloper: "Developer",
            roleManager: "Project Manager",
            roleDesigner: "Product Designer",
            balance: "Balance",
            usage: "This Month",
            navVirtualCards: "My virtual cards",
            virtualCardsTitle: "My virtual cards",
            allVirtualCards: "All virtual cards →",
            addCard: "Add virtual card",
            newCardTitle: "New virtual card",
            cardType: "Card Type",
            cardPurpose: "What is it for?",
            cardPurposePlaceholder: "Team Software Subscription (One Time)",
            cardAmount: "Amount",
            cardCurrency: "Currency",
            cardFrequency: "Frequency",
            cardDetails: "Request details",
            cardDetailsPlaceholder: "What else should we know about this request?",
            advancedSettings: "Advanced",
            advancedPlaceholder: "Sharing / Receipts, memos, and reviews / Spending controls and restrictions",
            cancel: "Cancel",
            requestCard: "Request card",
            cardStatusPending: "Pending",
            cardStatusActive: "Active",
            cardStatusFrozen: "Frozen",
            cardRequested: "Requested",
            cardAvailable: "Available",
            cardLimit: "Limit",
            cardApproval: "0 of 1 approval",
            cardUsed: "used",
            selectOption: "Please select",
            frequencyTotal: "Total",
            frequencyDaily: "Daily",
            frequencyWeekly: "Weekly",
            frequencyMonthly: "Monthly - limit resets every calendar month",
            frequencyQuarterly: "Quarterly",
            frequencyYearly: "Yearly",
          },
          ja: {
            navOverview: "概要",
            navWallet: "ウォレット",
            navEmployees: "従業員",
            navTransactions: "取引",
            navExpenses: "経費",
            navSettings: "設定",
            pageTitle: "ダッシュボード",
            userMenu: "ユーザー",
            statTotalBalance: "総残高",
            statChange: "+12.5% 今月",
            statAvailable: "利用可能",
            statReady: "割り当て可能",
            statEmployees: "従業員総数",
            statActive: "38 アクティブ",
            statMonthlyExpense: "月間経費",
            statVsLastMonth: "-8.2% 先月比",
            quickActions: "クイックアクション",
            actionDeposit: "法定通貨入金",
            actionDepositDesc: "Ramp経由で法定通貨を入金し、USDTに自動変換",
            actionAllocate: "予算割り当て",
            actionAllocateDesc: "従業員にUSDT予算を割り当て",
            actionOSL: "OSL統合",
            actionOSLDesc: "OSL取引所接続と設定を管理",
            actionReports: "レポート生成",
            actionReportsDesc: "経費と取引レポートをエクスポート",
            recentTransactions: "最近の取引",
            viewAll: "すべて表示",
            txDate: "日付",
            txType: "種類",
            txEmployee: "従業員",
            txAmount: "金額",
            txStatus: "ステータス",
            txDeposit: "入金",
            txAllocate: "割り当て",
            txExpense: "支出",
            txCompleted: "完了",
            txPending: "処理中",
            topEmployees: "アクティブな従業員",
            roleDeveloper: "開発者",
            roleManager: "プロジェクトマネージャー",
            roleDesigner: "プロダクトデザイナー",
            balance: "残高",
            usage: "今月の使用",
            navVirtualCards: "マイ仮想カード",
            virtualCardsTitle: "マイ仮想カード",
            allVirtualCards: "すべての仮想カード →",
            addCard: "仮想カードを追加",
            newCardTitle: "新しい仮想カード",
            cardType: "カード種類",
            cardPurpose: "用途",
            cardPurposePlaceholder: "Team Software Subscription (One Time)",
            cardAmount: "金額",
            cardCurrency: "通貨",
            cardFrequency: "頻度",
            cardDetails: "リクエスト詳細",
            cardDetailsPlaceholder: "What else should we know about this request?",
            advancedSettings: "高度な設定",
            advancedPlaceholder: "Sharing / Receipts, memos, and reviews / Spending controls and restrictions",
            cancel: "キャンセル",
            requestCard: "カードをリクエスト",
            cardStatusPending: "保留中",
            cardStatusActive: "アクティブ",
            cardStatusFrozen: "凍結",
            cardRequested: "リクエスト日",
            cardAvailable: "利用可能",
            cardLimit: "制限",
            cardApproval: "承認 0/1",
            cardUsed: "使用済み",
            selectOption: "選択してください",
            frequencyTotal: "合計",
            frequencyDaily: "日次",
            frequencyWeekly: "週次",
            frequencyMonthly: "月次 - 毎月のカレンダー月にリセット",
            frequencyQuarterly: "四半期",
            frequencyYearly: "年次",
          },
          de: {
            navOverview: "Übersicht",
            navWallet: "Wallet",
            navEmployees: "Mitarbeiter",
            navTransactions: "Transaktionen",
            navExpenses: "Ausgaben",
            navSettings: "Einstellungen",
            pageTitle: "Dashboard",
            userMenu: "Benutzer",
            statTotalBalance: "Gesamtsaldo",
            statChange: "+12.5% diesen Monat",
            statAvailable: "Verfügbar",
            statReady: "Bereit zur Zuteilung",
            statEmployees: "Mitarbeiter gesamt",
            statActive: "38 aktiv",
            statMonthlyExpense: "Monatliche Ausgaben",
            statVsLastMonth: "-8.2% vs. letzten Monat",
            quickActions: "Schnellaktionen",
            actionDeposit: "Fiat einzahlen",
            actionDepositDesc: "Fiat über Ramp einzahlen und automatisch in USDT umwandeln",
            actionAllocate: "Budget zuweisen",
            actionAllocateDesc: "USDT-Budget an Mitarbeiter zuweisen",
            actionOSL: "OSL-Integration",
            actionOSLDesc: "OSL-Börsenverbindung & Konfiguration verwalten",
            actionReports: "Berichte erstellen",
            actionReportsDesc: "Ausgaben- & Transaktionsberichte exportieren",
            recentTransactions: "Letzte Transaktionen",
            viewAll: "Alle anzeigen",
            txDate: "Datum",
            txType: "Typ",
            txEmployee: "Mitarbeiter",
            txAmount: "Betrag",
            txStatus: "Status",
            txDeposit: "Einzahlung",
            txAllocate: "Zuteilung",
            txExpense: "Ausgabe",
            txCompleted: "Abgeschlossen",
            txPending: "Ausstehend",
            topEmployees: "Aktive Mitarbeiter",
            roleDeveloper: "Entwickler",
            roleManager: "Projektmanager",
            roleDesigner: "Produktdesigner",
            balance: "Saldo",
            usage: "Diesen Monat",
            navVirtualCards: "Meine virtuellen Karten",
            virtualCardsTitle: "Meine virtuellen Karten",
            allVirtualCards: "Alle virtuellen Karten →",
            addCard: "Virtuelle Karte hinzufügen",
            newCardTitle: "Neue virtuelle Karte",
            cardType: "Kartentyp",
            cardPurpose: "Wofür ist es?",
            cardPurposePlaceholder: "Team Software Subscription (One Time)",
            cardAmount: "Betrag",
            cardCurrency: "Währung",
            cardFrequency: "Häufigkeit",
            cardDetails: "Anfragedetails",
            cardDetailsPlaceholder: "What else should we know about this request?",
            advancedSettings: "Erweitert",
            advancedPlaceholder: "Sharing / Receipts, memos, and reviews / Spending controls and restrictions",
            cancel: "Abbrechen",
            requestCard: "Karte anfordern",
            cardStatusPending: "Ausstehend",
            cardStatusActive: "Aktiv",
            cardStatusFrozen: "Eingefroren",
            cardRequested: "Angefordert",
            cardAvailable: "Verfügbar",
            cardLimit: "Limit",
            cardApproval: "0 von 1 Genehmigung",
            cardUsed: "verwendet",
            selectOption: "Bitte auswählen",
            frequencyTotal: "Gesamt",
            frequencyDaily: "Täglich",
            frequencyWeekly: "Wöchentlich",
            frequencyMonthly: "Monatlich - Limit wird jeden Kalendermonat zurückgesetzt",
            frequencyQuarterly: "Vierteljährlich",
            frequencyYearly: "Jährlich",
          },
          vi: {
            navOverview: "Tổng quan",
            navWallet: "Ví",
            navEmployees: "Nhân viên",
            navTransactions: "Giao dịch",
            navExpenses: "Chi phí",
            navSettings: "Cài đặt",
            pageTitle: "Bảng điều khiển",
            userMenu: "Người dùng",
            statTotalBalance: "Tổng số dư",
            statChange: "+12.5% tháng này",
            statAvailable: "Khả dụng",
            statReady: "Sẵn sàng phân bổ",
            statEmployees: "Tổng nhân viên",
            statActive: "38 đang hoạt động",
            statMonthlyExpense: "Chi phí tháng",
            statVsLastMonth: "-8.2% so với tháng trước",
            quickActions: "Thao tác nhanh",
            actionDeposit: "Nạp tiền pháp định",
            actionDepositDesc: "Nạp tiền pháp định qua Ramp và tự động chuyển đổi sang USDT",
            actionAllocate: "Phân bổ ngân sách",
            actionAllocateDesc: "Phân bổ ngân sách USDT cho nhân viên",
            actionOSL: "Tích hợp OSL",
            actionOSLDesc: "Quản lý kết nối & cấu hình sàn giao dịch OSL",
            actionReports: "Tạo báo cáo",
            actionReportsDesc: "Xuất báo cáo chi phí & giao dịch",
            recentTransactions: "Giao dịch gần đây",
            viewAll: "Xem tất cả",
            txDate: "Ngày",
            txType: "Loại",
            txEmployee: "Nhân viên",
            txAmount: "Số tiền",
            txStatus: "Trạng thái",
            txDeposit: "Nạp tiền",
            txAllocate: "Phân bổ",
            txExpense: "Chi tiêu",
            txCompleted: "Hoàn thành",
            txPending: "Đang xử lý",
            topEmployees: "Nhân viên tích cực",
            roleDeveloper: "Nhà phát triển",
            roleManager: "Quản lý dự án",
            roleDesigner: "Thiết kế sản phẩm",
            balance: "Số dư",
            usage: "Tháng này",
            navVirtualCards: "Thẻ ảo của tôi",
            virtualCardsTitle: "Thẻ ảo của tôi",
            allVirtualCards: "Tất cả thẻ ảo →",
            addCard: "Thêm thẻ ảo",
            newCardTitle: "Thẻ ảo mới",
            cardType: "Loại thẻ",
            cardPurpose: "Dùng để làm gì?",
            cardPurposePlaceholder: "Team Software Subscription (One Time)",
            cardAmount: "Số tiền",
            cardCurrency: "Tiền tệ",
            cardFrequency: "Tần suất",
            cardDetails: "Chi tiết yêu cầu",
            cardDetailsPlaceholder: "What else should we know about this request?",
            advancedSettings: "Nâng cao",
            advancedPlaceholder: "Sharing / Receipts, memos, and reviews / Spending controls and restrictions",
            cancel: "Hủy",
            requestCard: "Yêu cầu thẻ",
            cardStatusPending: "Đang chờ",
            cardStatusActive: "Hoạt động",
            cardStatusFrozen: "Đã đóng băng",
            cardRequested: "Đã yêu cầu",
            cardAvailable: "Có sẵn",
            cardLimit: "Giới hạn",
            cardApproval: "0/1 phê duyệt",
            cardUsed: "đã sử dụng",
            selectOption: "Vui lòng chọn",
            frequencyTotal: "Tổng",
            frequencyDaily: "Hàng ngày",
            frequencyWeekly: "Hàng tuần",
            frequencyMonthly: "Hàng tháng - giới hạn được đặt lại mỗi tháng dương lịch",
            frequencyQuarterly: "Hàng quý",
            frequencyYearly: "Hàng năm",
          },
        };

        const textNodes = document.querySelectorAll("[data-i18n]");
        const langButtons = document.querySelectorAll(".lang-option");
        const langToggle = document.getElementById("lang-toggle");

        function applyLanguage(lang) {
          const dict = translations[lang] || translations.zh;
          document.documentElement.lang = lang;

          // Update all text nodes with data-i18n
          const allTextNodes = document.querySelectorAll("[data-i18n]");
          allTextNodes.forEach((node) => {
            const key = node.dataset.i18n;
            if (dict[key]) {
              if (node.tagName === "INPUT" || node.tagName === "TEXTAREA") {
                node.placeholder = dict[key];
              } else if (node.tagName === "OPTION") {
                node.textContent = dict[key];
              } else if (node.tagName === "A" && node.querySelector("[data-i18n]")) {
                // Skip anchor tags that have child elements with data-i18n
                // The child elements will be updated separately
                return;
              } else {
                node.textContent = dict[key];
              }
            }
          });

          // Update text nodes with data-i18n-text (for labels with required asterisk)
          const textNodes = document.querySelectorAll("[data-i18n-text]");
          textNodes.forEach((node) => {
            const key = node.dataset.i18nText;
            if (dict[key]) {
              node.textContent = dict[key];
            }
          });

          // Update placeholder nodes
          const placeholderNodes = document.querySelectorAll("[data-i18n-placeholder]");
          placeholderNodes.forEach((input) => {
            const key = input.dataset.i18nPlaceholder;
            if (dict[key]) {
              input.placeholder = dict[key];
            }
          });

          // Re-render virtual cards to update dynamic content
          if (document.getElementById("virtual-cards-grid")) {
            renderVirtualCards();
          }
        }

        langButtons.forEach((button) => {
          button.addEventListener("click", () => {
            const lang = button.dataset.lang;
            langButtons.forEach((btn) => btn.classList.remove("active"));
            button.classList.add("active");
            applyLanguage(lang);
            if (langToggle) {
              langToggle.checked = false;
            }
          });
        });

        // Navigation active state and page switching
        const navItems = document.querySelectorAll(".nav-item");
        const dashboardSections = document.querySelectorAll(".dashboard-section:not(#virtual-cards-page)");
        const virtualCardsPage = document.getElementById("virtual-cards-page");
        
        function showDashboardOverview() {
          // Show all dashboard sections except virtual cards page
          dashboardSections.forEach((section) => {
            section.style.display = "flex";
          });
          // Hide virtual cards page
          if (virtualCardsPage) {
            virtualCardsPage.style.display = "none";
          }
        }

        function showVirtualCardsPage() {
          // Hide all dashboard sections
          dashboardSections.forEach((section) => {
            section.style.display = "none";
          });
          // Show virtual cards page
          if (virtualCardsPage) {
            virtualCardsPage.style.display = "flex";
            renderVirtualCards();
          }
        }

        navItems.forEach((item) => {
          item.addEventListener("click", (e) => {
            // 只对锚点链接阻止默认行为，允许实际文件链接正常跳转
            const href = item.getAttribute("href");
            if (href && href.startsWith("#")) {
              e.preventDefault();
              navItems.forEach((nav) => nav.classList.remove("active"));
              item.classList.add("active");
              
              // Switch pages based on navigation
              if (href === "#virtual-cards") {
                showVirtualCardsPage();
              } else if (href === "#overview" || href === "#employees" || href === "#transactions" || href === "#expenses") {
                showDashboardOverview();
              }
              // For actual file links (wallet.html, settings.html), allow normal navigation
            }
            // 对于实际文件链接（如 wallet.html, settings.html），允许正常跳转
          });
        });

        // Virtual Cards Data
        let virtualCards = [
          {
            id: 1,
            name: "New Advertising Card",
            status: "Pending",
            requestedAt: "2024-03-20",
            spent: 0,
            limit: 5000,
            currency: "USD",
            frequency: "Monthly",
          },
          {
            id: 2,
            name: "Meals & Entertainment",
            status: "Active",
            requestedAt: "2024-02-15",
            spent: 625.42,
            limit: 5000,
            currency: "USD",
            frequency: "Monthly",
          },
          {
            id: 3,
            name: "T&E Card",
            status: "Active",
            requestedAt: "2024-01-10",
            spent: 73.80,
            limit: 90,
            currency: "USD",
            frequency: "Monthly",
          },
        ];

        function renderVirtualCards() {
          const grid = document.getElementById("virtual-cards-grid");
          if (!grid) return;

          const currentLang = document.documentElement.lang || "zh";
          const dict = translations[currentLang] || translations.zh;

          grid.innerHTML = virtualCards
            .map((card) => {
              const available = card.limit - card.spent;
              const usagePercent = (card.spent / card.limit) * 100;
              const formattedDate = new Date(card.requestedAt).toLocaleDateString("en-US", {
                month: "2-digit",
                day: "2-digit",
                year: "numeric",
              });

              const statusText = dict[`cardStatus${card.status}`] || card.status;
              const requestedText = dict.cardRequested || "Requested";
              const approvalText = dict.cardApproval || "0 of 1 approval";
              const usedText = dict.cardUsed || "used";

              // For Pending cards, show different layout
              if (card.status === "Pending") {
                return `
                  <div class="virtual-card-item">
                    <div class="virtual-card-header">
                      <div class="virtual-card-title-group">
                        <h3 class="virtual-card-name">${card.name}</h3>
                        <p class="virtual-card-date" data-i18n="cardRequested">${requestedText} ${formattedDate}</p>
                      </div>
                      <span class="virtual-card-status status-${card.status.toLowerCase()}" data-i18n="cardStatus${card.status}">${statusText}</span>
                    </div>
                    <div class="virtual-card-content">
                      <div class="virtual-card-pending-info">
                        <span class="pending-text" data-i18n="cardApproval">${approvalText}</span>
                      </div>
                    </div>
                    <button class="virtual-card-detail-btn" onclick="openCardDetail(${card.id})">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M5 12h14M12 5l7 7-7 7"/>
                      </svg>
                    </button>
                  </div>
                `;
              }

              return `
                <div class="virtual-card-item">
                  <div class="virtual-card-header">
                    <div class="virtual-card-title-group">
                      <h3 class="virtual-card-name">${card.name}</h3>
                      <p class="virtual-card-date" data-i18n="cardRequested">${requestedText} ${formattedDate}</p>
                    </div>
                    <span class="virtual-card-status status-${card.status.toLowerCase()}" data-i18n="cardStatus${card.status}">${statusText}</span>
                  </div>
                  <div class="virtual-card-content">
                    <div class="virtual-card-amount">
                      <div class="amount-spent">
                        <span class="spent-value">$${card.spent.toFixed(2)}</span>
                      </div>
                      <div class="amount-limit">
                        <span class="limit-value">$${card.limit.toFixed(2)} ${card.currency} / ${card.frequency}</span>
                      </div>
                    </div>
                    <div class="virtual-card-progress">
                      <div class="progress-bar">
                        <div class="progress-fill" style="width: ${usagePercent}%"></div>
                      </div>
                      <span class="progress-text" data-i18n="cardUsed">${usagePercent.toFixed(1)}% ${usedText}</span>
                    </div>
                  </div>
                  <button class="virtual-card-detail-btn" onclick="openCardDetail(${card.id})">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M5 12h14M12 5l7 7-7 7"/>
                    </svg>
                  </button>
                </div>
              `;
            })
            .join("");

          // Re-apply i18n after rendering
          applyLanguage(currentLang);
        }

        // Initialize on page load
        function initializePage() {
          // Show dashboard overview by default
          showDashboardOverview();
          // Pre-render virtual cards (but don't show the page)
          renderVirtualCards();
        }

        if (document.readyState === "loading") {
          document.addEventListener("DOMContentLoaded", initializePage);
        } else {
          initializePage();
        }

        // Expose functions to global scope for onclick handlers
        window.openNewCardDrawer = function() {
          const drawer = document.getElementById("new-card-drawer");
          const overlay = document.getElementById("new-card-drawer-overlay");
          if (drawer && overlay) {
            drawer.classList.add("active");
            overlay.classList.add("active");
            document.body.style.overflow = "hidden";
          }
        };

        window.closeNewCardDrawer = function() {
          const drawer = document.getElementById("new-card-drawer");
          const overlay = document.getElementById("new-card-drawer-overlay");
          if (drawer && overlay) {
            drawer.classList.remove("active");
            overlay.classList.remove("active");
            document.body.style.overflow = "";
            // Reset form
            const form = document.getElementById("new-card-form");
            if (form) {
              form.reset();
            }
          }
        };

        function handleCardSubmit(event) {
          event.preventDefault();
          const form = event.target;
          const formData = new FormData(form);

          // Validation
          const amount = parseFloat(formData.get("amount"));
          if (!amount || amount <= 0) {
            alert("Please enter a valid amount");
            return;
          }

          // Create new card
          const newCard = {
            id: virtualCards.length + 1,
            name: formData.get("purpose") || "New Card",
            status: "Pending",
            requestedAt: new Date().toISOString().split("T")[0],
            spent: 0,
            limit: amount,
            currency: formData.get("currency"),
            frequency: formData.get("frequency"),
          };

          virtualCards.push(newCard);
          renderVirtualCards();
          window.closeNewCardDrawer();
        }

        function openCardDetail(cardId) {
          // Placeholder for card detail drawer
          console.log("Open card detail:", cardId);
        }

        // Close drawer when clicking overlay
        document.addEventListener("click", (e) => {
          if (e.target.id === "new-card-drawer-overlay") {
            window.closeNewCardDrawer();
          }
        });

        // Close drawer on Escape key
        document.addEventListener("keydown", (e) => {
          if (e.key === "Escape") {
            window.closeNewCardDrawer();
          }
        });

        applyLanguage("zh");
      })();
    </script>
  </body>
</html>

